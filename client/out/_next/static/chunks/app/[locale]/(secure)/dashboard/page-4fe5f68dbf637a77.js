(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[416],{26068:function(e,a,t){Promise.resolve().then(t.bind(t,96675))},45394:function(e,a,t){"use strict";t.d(a,{C:function(){return l},T:function(){return n}});var r=t(68575);let n=r.I0,l=r.v9},84876:function(e,a,t){"use strict";t.d(a,{AW:function(){return i},Nq:function(){return f},av:function(){return v},h8:function(){return g},r7:function(){return p},x4:function(){return s}});var r=t(1455),n=t(83464),l=t(43577),o=t(64131);let d="".concat("https://stagingsrv.gazala.net/api","/users"),s=(0,r.hg)("user/login",async(e,a)=>{let{email:t,password:r}=e;try{let e=await fetch("".concat("https://stagingsrv.gazala.net/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:r})});if(!e.ok){let a=await e.json();throw Error(a.message||"Login failed.")}return await e.json()}catch(e){return a.rejectWithValue(e.message||"An unknown error occurred.")}}),i=(0,r.hg)("user/fetchAll",async(e,a)=>{let{rejectWithValue:t}=a;try{let e=await n.default.get("".concat(d),{headers:{Authorization:"Bearer ".concat(o.Z.get("auth_token"))}});return console.log(e.data),e.data.data}catch(e){if(e instanceof l.d7){var r;return t((null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.data)||"Failed to fetch users")}throw Error("An unknown error occurred.")}}),u=(0,r.hg)("user/fetchById",async(e,a)=>{let{rejectWithValue:t}=a,r=o.Z.get("auth_token");if(!r)throw Error("No authorization token found");try{return(await n.default.get("".concat(d,"/").concat(e),{headers:{Authorization:"Bearer ".concat(r)}})).data.data}catch(e){if(e instanceof l.d7){var s;return t((null==e?void 0:null===(s=e.response)||void 0===s?void 0:s.data)||"Failed to fetch user")}}}),c=(0,r.hg)("user/addNewUser",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await n.default.post("".concat(d),e,{headers:{Authorization:"Bearer ".concat(o.Z.get("auth_token"))}});return null==a?void 0:a.data}catch(e){if(e instanceof l.d7){var r;return t((null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.data)||"Failed to add new user")}}}),f=(0,r.hg)("user/update",async(e,a)=>{let{id:t,userData:r}=e,{rejectWithValue:s}=a;try{let e=await n.default.patch("".concat(d,"/").concat(t),r,{headers:{Authorization:"Bearer ".concat(o.Z.get("auth_token"))}});return null==e?void 0:e.data}catch(e){if(e instanceof l.d7){var i;return s((null==e?void 0:null===(i=e.response)||void 0===i?void 0:i.data)||"Failed to update user")}}}),g=(0,r.hg)("user/delete",async(e,a)=>{let{dispatch:t,rejectWithValue:r}=a;try{return await n.default.delete("".concat(d,"/").concat(e),{headers:{Authorization:"Bearer ".concat(o.Z.get("auth_token"))}}),t(y(e)),e}catch(e){if(e instanceof l.d7){var s;return r((null==e?void 0:null===(s=e.response)||void 0===s?void 0:s.data)||"Failed to delete user")}}}),h=(0,r.oM)({name:"user",initialState:{isAuthenticated:!1,token:null,user:null,loading:!1,error:null,allUsers:[],activeTab:"1"},reducers:{setActiveTab:(e,a)=>{e.activeTab=a.payload},logout(e){e.user=null,e.allUsers=[]},setUser(e,a){e.isAuthenticated=!0,e.user=a.payload},removeUser(e,a){e.allUsers=e.allUsers.filter(e=>e._id!==a.payload)}},extraReducers:e=>{e.addCase(s.pending,e=>{e.loading=!0,e.error=null}).addCase(s.fulfilled,(e,a)=>{e.loading=!1,e.token=a.payload.token,e.user={fName:a.payload.fname,lName:a.payload.lName,role:a.payload.role,email:a.payload.email},e.isAuthenticated=!0}).addCase(s.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"Failed to login. Please try again."}).addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload}).addCase(u.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to fetch user."}).addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.loading=!1,e.allUsers=a.payload}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to fetch users."}).addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.loading=!1,e.allUsers?e.allUsers=[...e.allUsers,a.payload]:e.allUsers=[a.payload]}).addCase(c.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to add new user"}).addCase(f.pending,e=>{e.loading=!0,e.error=null}).addCase(f.fulfilled,(e,a)=>{e.loading=!1,e.allUsers&&(e.allUsers=e.allUsers.map(e=>e._id===a.payload._id?a.payload:e))}).addCase(f.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to update user."})}}),{setActiveTab:p,setUser:v,removeUser:y}=h.actions;a.ZP=h.reducer},96675:function(e,a,t){"use strict";t.r(a);var r=t(57437),n=t(2265),l=t(45394),o=t(64131),d=t(99376),s=t(84876),i=t(42586);a.default=()=>{let[e,a]=(0,n.useState)(null),{loading:u}=(0,l.C)(e=>e.user),c=(0,d.useRouter)(),f=o.Z.get("auth_token"),g=(0,l.T)();return((0,i.useLocale)(),(0,n.useEffect)(()=>{let e;try{e=JSON.parse(window.localStorage.getItem("user"))}catch(a){e={}}e&&g((0,s.av)(e)),f&&(null==e||e.role),(async()=>{{let e=await Promise.all([t.e(9562),t.e(7648),t.e(3537),t.e(6752),t.e(1339),t.e(1008),t.e(2624)]).then(t.bind(t,42624));a(()=>e.default)}})()},[f,g,c]),u)?(0,r.jsx)("p",{children:"Loading..."}):e?(0,r.jsx)(e,{}):null}},43577:function(e,a,t){"use strict";t.d(a,{d7:function(){return n}});let{Axios:r,AxiosError:n,CanceledError:l,isCancel:o,CancelToken:d,VERSION:s,all:i,Cancel:u,isAxiosError:c,spread:f,toFormData:g,AxiosHeaders:h,HttpStatusCode:p,formToJSON:v,getAdapter:y,mergeConfig:w}=t(83464).default}},function(e){e.O(0,[2292,2586,3464,2971,2117,1744],function(){return e(e.s=26068)}),_N_E=e.O()}]);