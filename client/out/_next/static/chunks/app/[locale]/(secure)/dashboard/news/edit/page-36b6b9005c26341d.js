(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1169],{22998:function(e,a,t){Promise.resolve().then(t.bind(t,80224))},41221:function(e,a,t){"use strict";var r=t(2265),n=t(40718),s=t.n(n),i=t(36760),l=t.n(i),d=t(28137),c=["className","cssModule","type","size","color","children","tag"];function o(){return(o=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var u={tag:d.iC,type:s().oneOf(["border","grow"]),size:s().oneOf(["sm"]),color:s().oneOf(["primary","secondary","success","danger","warning","info","light","dark"]),className:s().string,cssModule:s().object,children:s().string};function h(e){var a=e.className,t=e.cssModule,n=e.type,s=void 0===n?"border":n,i=e.size,u=e.color,h=e.children,m=void 0===h?"Loading...":h,p=e.tag,f=function(e,a){if(null==e)return{};var t,r,n=function(e,a){if(null==e)return{};var t,r,n={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],!(a.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(n[t]=e[t])}return n}(e,c),x=(0,d.mx)(l()(a,!!i&&"spinner-".concat(s,"-").concat(i),"spinner-".concat(s),!!u&&"text-".concat(u)),t);return r.createElement(void 0===p?"div":p,o({role:"status"},f,{className:x}),m&&r.createElement("span",{className:(0,d.mx)("visually-hidden",t)},m))}h.propTypes=u,a.Z=h},80224:function(e,a,t){"use strict";t.d(a,{default:function(){return K}});var r=t(57437),n=t(2265),s=t(71008),i=t(99914),l=t(50288),d=t(98723),c=t(41221),o=t(60729),u=t(65051),h=t(75722),m=t(73215),p=t(79205),f=t(17851),x=t(45394),g=t(19726),j=t(5551),v=t(53514),w=t(12121),y=()=>{let{navId:e}=(0,x.C)(e=>e.editNews),a=(0,x.T)();return(0,r.jsx)(d.Z,{xxl:"3",xl:"4",className:"box-col-4e sidebar-left-wrapper mb-2 add-product-tab",children:(0,r.jsx)(j.Z,{pills:!0,className:"sidebar-left-icons border-0",tabs:!0,children:f.iS.map((t,n)=>(0,r.jsx)(v.Z,{children:(0,r.jsxs)(w.Z,{className:"border-0",active:e===t.id,onClick:()=>a((0,g.YB)(t.id)),children:[(0,r.jsx)("div",{className:"nav-rounded",children:(0,r.jsx)("div",{className:"product-icons",children:(0,r.jsx)(p.Z,{className:"stroke-icon",iconId:t.icon})})}),(0,r.jsxs)("div",{className:"product-tab-content",children:[(0,r.jsx)("h5",{children:t.title}),(0,r.jsx)("p",{children:t.detail})]})]})},n))})})},N=t(67061),b=t(62302),Z=t(50720),C=t(82097),k=t(95029),A=t(31538),_=t(97458),F=t.n(_),I=e=>{let{contentName:a}=e,{formValue:t}=(0,x.C)(e=>e.editNews),n=(0,x.T)();return(0,r.jsx)(u.Z,{children:(0,r.jsx)(m.Z,{children:(0,r.jsx)("div",{style:{width:"100%",height:"400px",overflow:"auto"},children:(0,r.jsx)(A.vM,{editor:F(),data:t[a],onChange:(e,t)=>{let r=t.getData();n((0,g.my)({name:a,value:r}))}})})})})},z=e=>{let{titleName:a="title",contentName:t="content"}=e,{formValue:n}=(0,x.C)(e=>e.editNews),i=(0,x.T)();return(0,r.jsx)("div",{className:"sidebar-body",children:(0,r.jsx)(Z.Z,{children:(0,r.jsxs)(l.Z,{className:"g-2",children:[(0,r.jsx)(d.Z,{xs:"12",children:(0,r.jsxs)(C.Z,{className:"m-0",check:!0,children:[s.KPX," ",(0,r.jsx)("span",{className:"txt-danger",children:" *"})]})}),(0,r.jsx)(d.Z,{xs:"12",children:(0,r.jsx)("div",{className:"custom-input",children:(0,r.jsx)(k.Z,{value:n[a],className:""!==n[a]?"valid":"is-invalid",type:"text",required:!0,name:a,onChange:e=>i((0,g.my)({name:a,value:e.target.value}))})})}),(0,r.jsx)(I,{contentName:t})]})})})},O=t(94926),P=t(180),T=t(48055),D=()=>{let[e,a]=(0,n.useState)([]),t=(0,x.T)(),{formValue:s}=(0,x.C)(e=>e.editNews),i=e=>{a(e);let r=e.filter(e=>e.valid).map(e=>e.file);t((0,g.my)({name:"images",value:r}))},l=r=>{let n=e.filter(e=>e.id!==r);a(n);let s=n.filter(e=>e.valid).map(e=>e.file);t((0,g.my)({name:"images",value:s}))};return(0,n.useEffect)(()=>{(async()=>{s.images&&Array.isArray(s.images)&&a((await Promise.all(s.images.map(async e=>{try{let a=await (0,P.f)("https://stagingsrv.gazala.net/api/"+e,(0,T.w)("https://stagingsrv.gazala.net/api/"+e));return{id:a.name,name:a.name,size:a.size,type:a.type,valid:!0,preview:!0,file:a}}catch(e){return console.error("Failed to convert image URL to file:",e),null}}))).filter(e=>null!==e))})()},[]),(0,r.jsxs)("div",{className:"product-upload",children:[(0,r.jsxs)("p",{children:["News Gallery",(0,r.jsx)("span",{className:"txt-danger",children:" *"})]}),(0,r.jsxs)(O.fh,{onChange:e=>i(e),value:e,maxFiles:5,header:!1,footer:!1,minHeight:"80px",name:"images",children:[e.map(e=>(0,r.jsx)(O.Q$,{...e,onDelete:l,info:!0,preview:!0},e.id)),0===e.length&&(0,r.jsxs)("div",{className:"dz-message needsclick",children:[(0,r.jsx)(p.Z,{iconId:"file-upload1"}),(0,r.jsx)("h5",{children:"Drag Images here"}),(0,r.jsx)("span",{className:"note needsclick",children:"Update News Gallery Images"})]})]})]})},E=t(27648),S=()=>{let[e,a]=(0,n.useState)([]),t=(0,x.T)(),{formValue:i}=(0,x.C)(e=>e.editNews),[l,d]=(0,n.useState)(!1),c=e=>{a(e);let r=e.filter(e=>!0===e.valid);t((0,g.my)({name:"thumbnail",value:r[0].file}))},o=t=>{a(e.filter(e=>e.id!==t))};return(0,n.useEffect)(()=>{d(!0),(async()=>{if(i.thumbnail&&!Array.isArray(i.thumbnail))try{let e=await (0,P.f)("https://stagingsrv.gazala.net/api/"+i.thumbnail,(0,T.w)("https://stagingsrv.gazala.net/api/"+i.thumbnail)),t={id:e.name,name:e.name,size:e.size,type:e.type,valid:!0,file:e,preview:!0};a([t])}catch(e){console.error("Failed to convert thumbnail URL to file:",e)}})()},[]),(0,r.jsxs)("div",{className:"sidebar-body",children:[(0,r.jsxs)("div",{className:"product-upload",children:[(0,r.jsxs)("p",{children:["News Thumbnail",(0,r.jsx)("span",{className:"txt-danger",children:" *"})," "]}),(0,r.jsxs)(O.fh,{onChange:e=>c(e),value:e,maxFiles:1,header:!1,footer:!1,minHeight:"80px",name:"thumbnail",children:[e.map(e=>(0,r.jsx)(O.Q$,{...e,onDelete:o,info:!0,preview:!0},e.id)),0===e.length&&(0,r.jsxs)("div",{className:"dz-message needsclick",children:[(0,r.jsx)(p.Z,{iconId:"file-upload"}),(0,r.jsxs)("h5",{children:["Drag your Thumbnail here, or",(0,r.jsx)(E.default,{className:"txt-primary",href:s.zOc,children:"\xa0browser"})]}),(0,r.jsx)("span",{className:"note needsclick",children:"SVG,PNG,JPG or GIF"})]})]})]}),(0,r.jsx)(D,{})]})},B=()=>{let e=(0,x.T)(),{published:a}=(0,x.C)(e=>e.editNews.formValue),t=a=>{e((0,g.my)({name:"published",value:a}))};return(0,r.jsx)(d.Z,{sm:"6",children:(0,r.jsx)(l.Z,{children:(0,r.jsxs)(d.Z,{xs:"12",children:[(0,r.jsxs)(C.Z,{for:"validationServer01",check:!0,children:["Publish",(0,r.jsx)("span",{className:"txt-danger",children:" *"})]}),(0,r.jsxs)(k.Z,{value:a,type:"select",name:"published",onChange:e=>t(e.target.value),children:[(0,r.jsx)("option",{value:"true",children:"Publish"}),(0,r.jsx)("option",{value:"false",children:"UnPublish"})]}),(0,r.jsx)("p",{className:"f-light",children:"Choose the status"})]})})})},L=t(85994),U=t.n(L),R=()=>{let e=(0,x.T)(),{formValue:a}=(0,x.C)(e=>e.editNews),[t,s]=(0,n.useState)(new Date);return(0,r.jsx)(d.Z,{sm:"6",children:(0,r.jsx)(l.Z,{children:(0,r.jsxs)(d.Z,{xs:"12",children:[(0,r.jsx)(C.Z,{for:"validationServer01",check:!0,children:"Date"}),(0,r.jsx)("div",{className:"input-group flatpicker-calender product-date",children:(0,r.jsx)(U(),{className:"form-control flatpickr-input",selected:a.date,onChange:a=>{s(a),e((0,g.my)({name:"date",value:a}))}})})]})})})},V=()=>(0,r.jsx)("div",{className:"sidebar-body",children:(0,r.jsx)(Z.Z,{children:(0,r.jsxs)(l.Z,{className:"g-lg-4 g-3",children:[(0,r.jsx)(d.Z,{xs:"12",children:(0,r.jsx)(l.Z,{className:"g-3",children:(0,r.jsx)(B,{})})}),(0,r.jsx)(d.Z,{children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(R,{})})})]})})}),Y=t(7299),G=t(42586),M=t(99376),H=t(18206),$=t(80201),J=e=>{let{slug:a}=e,{navId:t,formValue:n,tabId:i}=(0,x.C)(e=>e.editNews),l=(0,x.T)(),d=(0,M.useRouter)(),c=(0,G.useLocale)(),o=async e=>{try{let t=await l((0,Y.jB)({updatedNews:e,id:a})).unwrap();if(!0===t.status)H.Am.success("News updated successfully!"),d.push("/".concat(c,"/dashboard/news/")),l((0,g.YB)(1));else{let e=t.error.message;H.Am.error((null==e?void 0:e.message)||"Failed to update news.")}}catch(e){e instanceof Error?H.Am.error(e.message||"Failed to update news."):H.Am.error("Failed to update news.")}},u=()=>1!==t||n.title&&n.content?2!==t||n.title_ar&&n.content_ar?3!==t||n.thumbnail&&n.images?4!==t||!!n.date||(H.Am.error("Please select a date and status."),!1):(H.Am.error("Please upload a thumbnail and images."),!1):(H.Am.error("Please fill all fields in Arabic details."),!1):(H.Am.error("Please fill all fields in English details."),!1),h=e=>!isNaN(new Date(e).getTime());return(0,r.jsxs)("div",{className:"product-buttons border-0",children:[t>1&&(0,r.jsx)($.Z,{color:"transparent",onClick:()=>{t>1&&(i>1?l((0,g.dH)(i-1)):l((0,g.YB)(t-1)))},children:(0,r.jsxs)("div",{className:"d-flex align-items-center gap-sm-2 gap-1",children:[(0,r.jsx)(p.Z,{iconId:"back-arrow"}),s.L$3]})}),(0,r.jsx)($.Z,{color:"transparent",className:"ms-2",onClick:()=>{if(u()){if(1===t)l((0,g.YB)(2));else if(2===t)l((0,g.YB)(3));else if(3===t)l((0,g.YB)(4));else if(4===t){if(!h(n.date)){H.Am.error("Please enter a valid date.");return}let e=new FormData;e.append("title",n.title),e.append("title_ar",n.title_ar),e.append("description",n.description),e.append("description_ar",n.description_ar),e.append("date",new Date(n.date).toISOString()),e.append("published",String(n.published)),n.thumbnail&&e.append("thumbnail",n.thumbnail),Array.isArray(n.images)&&n.images.forEach(a=>{e.append("images",a)}),o(e)}}},children:(0,r.jsxs)("div",{className:"d-flex align-items-center gap-sm-2 gap-1",children:[4===t?"Submit":"Next",(0,r.jsx)(p.Z,{iconId:"front-arrow"})]})})]})},Q=e=>{let{slug:a}=e,{navId:t}=(0,x.C)(e=>e.editNews);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{xxl:"9",xl:"8",className:"box-col-8 position-relative",children:(0,r.jsxs)(N.Z,{activeTab:t,children:[(0,r.jsx)(b.Z,{tabId:1,children:(0,r.jsx)(z,{titleName:"title",contentName:"description"})}),(0,r.jsx)(b.Z,{tabId:2,children:(0,r.jsx)(z,{titleName:"title_ar",contentName:"description_ar"})}),(0,r.jsx)(b.Z,{tabId:3,children:(0,r.jsx)(S,{})}),(0,r.jsx)(b.Z,{tabId:4,children:(0,r.jsx)(V,{})})]})}),(0,r.jsx)(J,{slug:a})]})},q=e=>{let{slug:a}=e;return(0,r.jsxs)(l.Z,{className:"g-xl-5 g-3",children:[(0,r.jsx)(y,{}),(0,r.jsx)(Q,{slug:a})]})},K=()=>{let e=(0,x.T)(),{currentNews:a,loading:t,error:p}=(0,x.C)(e=>e.news),f=(0,M.useSearchParams)().get("id");return((0,n.useEffect)(()=>{e((0,Y.sv)(f))},[e,f]),(0,n.useEffect)(()=>{a&&Object.keys(a).forEach(t=>{if("date"===t){let r=new Date(a[t]);isNaN(r.getTime())?console.error("Invalid date value:",a[t]):e((0,g.my)({name:t,value:r}))}else e((0,g.my)({name:t,value:a[t]}))})},[a,e]),t)?(0,r.jsx)(i.Z,{fluid:!0,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(d.Z,{xs:"12",className:"text-center",children:(0,r.jsx)(c.Z,{color:"primary"})})})}):p?(0,r.jsx)(i.Z,{fluid:!0,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(d.Z,{xs:"12",children:(0,r.jsx)(o.Z,{color:"danger",children:p})})})}):(0,r.jsx)(i.Z,{fluid:!0,children:(0,r.jsx)(l.Z,{children:(0,r.jsx)(d.Z,{xs:"12",children:(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(h.Z,{children:(0,r.jsx)("h5",{children:s.zJ$})}),(0,r.jsx)(m.Z,{children:(0,r.jsx)(q,{slug:f})})]})})})})}},19726:function(e,a,t){"use strict";t.d(a,{YB:function(){return d},dH:function(){return c},my:function(){return i}});var r=t(1455);let n={navId:1,tabId:1,formValue:{title:"",title_ar:"",content:"",content_ar:"",thumbnail:"",images:[],published:!0,date:new Date,features:[],features_ar:[],author:"Ahmed"}},s=(0,r.oM)({name:"editNews",initialState:n,reducers:{setNavId:(e,a)=>{e.navId=a.payload},setTabId:(e,a)=>{e.tabId=a.payload},setFormValue:(e,a)=>{e.formValue={...e.formValue,[a.payload.name]:a.payload.value}},resetForm(e){e.formValue=n.formValue}}}),{setFormValue:i,resetForm:l,setNavId:d,setTabId:c}=s.actions;a.ZP=s.reducer},7299:function(e,a,t){"use strict";t.d(a,{aL:function(){return d},jB:function(){return h},kN:function(){return u},r7:function(){return p},sv:function(){return c}});var r=t(1455),n=t(83464),s=t(43577),i=t(64131);let l="".concat("https://stagingsrv.gazala.net/api","/edit-website/news"),d=(0,r.hg)("news/fetchNews",async()=>{try{return(await n.default.get(l,{headers:{Authorization:"Bearer ".concat(i.Z.get("auth_token"))}})).data.data}catch(a){if(console.error("Fetch news error:",a),a instanceof s.d7){var e;return(null==a?void 0:null===(e=a.response)||void 0===e?void 0:e.data)||"An unexpected error occurred."}}}),c=(0,r.hg)("news/fetchNewsById",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await n.default.get("".concat(l,"/").concat(e),{headers:{Authorization:"Bearer ".concat(i.Z.get("auth_token"))}});if(200!==a.status)return t(a.data.message||"Failed to fetch news item.");return a.data}catch(e){if(e instanceof s.d7){var r;return t((null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.data)||"An unexpected error occurred.")}}}),o=(0,r.hg)("news/fetchNewsBySlug",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await n.default.get("".concat(l,"/").concat(e),{headers:{Authorization:"Bearer ".concat(i.Z.get("auth_token"))}});if(200!==a.status)return t(a.data.message||"Failed to fetch news item.");return a.data}catch(e){if(e instanceof s.d7){var r;return t((null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.data)||"An unexpected error occurred.")}}}),u=(0,r.hg)("news/deleteNews",async(e,a)=>{let{dispatch:t,rejectWithValue:r}=a;try{let a=await n.default.delete("".concat(l,"/").concat(e),{headers:{Authorization:"Bearer ".concat(i.Z.get("auth_token"))}});if(200!==a.status){let e=a.data;return r(e.message||"Failed to delete news item.")}return t(f(e)),e}catch(e){if(e instanceof s.d7){var d;return r((null===(d=e.response)||void 0===d?void 0:d.data)||"An unexpected error occurred.")}}}),h=(0,r.hg)("news/updateNews",async(e,a)=>{let{updatedNews:t,id:r}=e,{dispatch:d,rejectWithValue:c}=a;try{let e=await n.default.patch("".concat(l,"/").concat(r),t,{headers:{Authorization:"Bearer ".concat(i.Z.get("auth_token"))}});if(200!==e.status){let a=e.data;return c(a.message||"Failed to update news item.")}let a=e.data;return d(x(a)),a}catch(e){if(e instanceof s.d7){var o;return c((null===(o=e.response)||void 0===o?void 0:o.data)||"An unexpected error occurred.")}}}),m=(0,r.oM)({name:"news",initialState:{newsData:[],activeTab:"1",currentNews:null,loading:!1,error:null},reducers:{setActiveTab:(e,a)=>{e.activeTab=a.payload},removeNews:(e,a)=>{e.newsData=e.newsData.filter(e=>e._id!==a.payload)},setCurrentNews:(e,a)=>{e.currentNews=a.payload},clearCurrentNews:e=>{e.currentNews=null}},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.loading=!1,e.newsData=a.payload}).addCase(d.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to load news data."}).addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.loading=!1,e.currentNews=a.payload.data}).addCase(c.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Unknown error"}).addCase(h.pending,e=>{e.loading=!0,e.error=null}).addCase(h.fulfilled,(e,a)=>{e.loading=!1;let t=e.newsData.findIndex(e=>e._id===a.payload._id);-1!==t&&(e.newsData[t]=a.payload),e.currentNews=a.payload}).addCase(h.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to update news item."}).addCase(o.pending,e=>{e.loading=!0,e.error=null}).addCase(o.fulfilled,(e,a)=>{e.loading=!1,e.currentNews=a.payload}).addCase(o.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Unknown error"})}}),{setActiveTab:p,removeNews:f,setCurrentNews:x,clearCurrentNews:g}=m.actions;a.ZP=m.reducer},180:function(e,a,t){"use strict";t.d(a,{f:function(){return r}});let r=async(e,a)=>{if(e instanceof File)return e;if(!e||"string"!=typeof e)throw Error("Invalid URL provided: "+e);try{let t=await fetch(e);if(!t.ok){if(404===t.status)return console.warn("File not found at URL: ".concat(e)),new File([],a);throw Error("Failed to fetch image from URL: ".concat(e))}let r=await t.blob();return new File([r],a,{type:r.type})}catch(e){return console.error("Error converting URL to file:",e),new File([],a)}}},48055:function(e,a,t){"use strict";t.d(a,{w:function(){return r}});let r=e=>{try{return new URL(e).pathname.split("/").pop()||"default_filename.png"}catch(a){return console.error("Invalid URL provided:",e),"default_filename.png"}}},43577:function(e,a,t){"use strict";t.d(a,{d7:function(){return n}});let{Axios:r,AxiosError:n,CanceledError:s,isCancel:i,CancelToken:l,VERSION:d,all:c,Cancel:o,isAxiosError:u,spread:h,toFormData:m,AxiosHeaders:p,HttpStatusCode:f,formToJSON:x,getAdapter:g,mergeConfig:j}=t(83464).default}},function(e){e.O(0,[9041,2292,2586,3464,7648,3537,8206,6474,6752,2897,5994,3181,1538,1008,4196,2971,2117,1744],function(){return e(e.s=22998)}),_N_E=e.O()}]);