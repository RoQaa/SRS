(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5507],{68164:function(e,a,t){Promise.resolve().then(t.bind(t,83481))},45394:function(e,a,t){"use strict";t.d(a,{C:function(){return s},T:function(){return l}});var r=t(68575);let l=r.I0,s=r.v9},84876:function(e,a,t){"use strict";t.d(a,{AW:function(){return i},Nq:function(){return h},av:function(){return m},h8:function(){return g},r7:function(){return p},x4:function(){return d}});var r=t(1455),l=t(83464),s=t(43577),n=t(64131);let o="".concat("https://stagingsrv.gazala.net/api","/users"),d=(0,r.hg)("user/login",async(e,a)=>{let{email:t,password:r}=e;try{let e=await fetch("".concat("https://stagingsrv.gazala.net/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:r})});if(!e.ok){let a=await e.json();throw Error(a.message||"Login failed.")}return await e.json()}catch(e){return a.rejectWithValue(e.message||"An unknown error occurred.")}}),i=(0,r.hg)("user/fetchAll",async(e,a)=>{let{rejectWithValue:t}=a;try{let e=await l.default.get("".concat(o),{headers:{Authorization:"Bearer ".concat(n.Z.get("auth_token"))}});return console.log(e.data),e.data.data}catch(e){if(e instanceof s.d7){var r;return t((null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.data)||"Failed to fetch users")}throw Error("An unknown error occurred.")}}),c=(0,r.hg)("user/fetchById",async(e,a)=>{let{rejectWithValue:t}=a,r=n.Z.get("auth_token");if(!r)throw Error("No authorization token found");try{return(await l.default.get("".concat(o,"/").concat(e),{headers:{Authorization:"Bearer ".concat(r)}})).data.data}catch(e){if(e instanceof s.d7){var d;return t((null==e?void 0:null===(d=e.response)||void 0===d?void 0:d.data)||"Failed to fetch user")}}}),u=(0,r.hg)("user/addNewUser",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await l.default.post("".concat(o),e,{headers:{Authorization:"Bearer ".concat(n.Z.get("auth_token"))}});return null==a?void 0:a.data}catch(e){if(e instanceof s.d7){var r;return t((null==e?void 0:null===(r=e.response)||void 0===r?void 0:r.data)||"Failed to add new user")}}}),h=(0,r.hg)("user/update",async(e,a)=>{let{id:t,userData:r}=e,{rejectWithValue:d}=a;try{let e=await l.default.patch("".concat(o,"/").concat(t),r,{headers:{Authorization:"Bearer ".concat(n.Z.get("auth_token"))}});return null==e?void 0:e.data}catch(e){if(e instanceof s.d7){var i;return d((null==e?void 0:null===(i=e.response)||void 0===i?void 0:i.data)||"Failed to update user")}}}),g=(0,r.hg)("user/delete",async(e,a)=>{let{dispatch:t,rejectWithValue:r}=a;try{return await l.default.delete("".concat(o,"/").concat(e),{headers:{Authorization:"Bearer ".concat(n.Z.get("auth_token"))}}),t(v(e)),e}catch(e){if(e instanceof s.d7){var d;return r((null==e?void 0:null===(d=e.response)||void 0===d?void 0:d.data)||"Failed to delete user")}}}),f=(0,r.oM)({name:"user",initialState:{isAuthenticated:!1,token:null,user:null,loading:!1,error:null,allUsers:[],activeTab:"1"},reducers:{setActiveTab:(e,a)=>{e.activeTab=a.payload},logout(e){e.user=null,e.allUsers=[]},setUser(e,a){e.isAuthenticated=!0,e.user=a.payload},removeUser(e,a){e.allUsers=e.allUsers.filter(e=>e._id!==a.payload)}},extraReducers:e=>{e.addCase(d.pending,e=>{e.loading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.loading=!1,e.token=a.payload.token,e.user={fName:a.payload.fname,lName:a.payload.lName,role:a.payload.role,email:a.payload.email},e.isAuthenticated=!0}).addCase(d.rejected,(e,a)=>{e.loading=!1,e.error=a.payload||"Failed to login. Please try again."}).addCase(c.pending,e=>{e.loading=!0,e.error=null}).addCase(c.fulfilled,(e,a)=>{e.loading=!1,e.user=a.payload}).addCase(c.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to fetch user."}).addCase(i.pending,e=>{e.loading=!0,e.error=null}).addCase(i.fulfilled,(e,a)=>{e.loading=!1,e.allUsers=a.payload}).addCase(i.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to fetch users."}).addCase(u.pending,e=>{e.loading=!0,e.error=null}).addCase(u.fulfilled,(e,a)=>{e.loading=!1,e.allUsers?e.allUsers=[...e.allUsers,a.payload]:e.allUsers=[a.payload]}).addCase(u.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to add new user"}).addCase(h.pending,e=>{e.loading=!0,e.error=null}).addCase(h.fulfilled,(e,a)=>{e.loading=!1,e.allUsers&&(e.allUsers=e.allUsers.map(e=>e._id===a.payload._id?a.payload:e))}).addCase(h.rejected,(e,a)=>{e.loading=!1,e.error=a.error.message||"Failed to update user."})}}),{setActiveTab:p,setUser:m,removeUser:v}=f.actions;a.ZP=f.reducer},83481:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return k}});var r=t(57437),l=t(2265),s=t(99914),n=t(50288),o=t(98723),d=t(71008),i=t(64131),c=t(27648),u=t(99376),h=t(18206),g=t(50720),f=t(60729),p=t(43207),m=t(82097),v=t(95029),y=t(80201),j=t(45394),x=t(84876),N=t(42586),w=()=>{let e=(0,N.useLocale)(),[a,t]=(0,l.useState)(!1),[s,n]=(0,l.useState)(""),[o,w]=(0,l.useState)(""),[k,C]=(0,l.useState)(""),Z=(0,u.useRouter)(),[_,U]=(0,l.useState)(!0),b=(0,j.T)(),A=async a=>{a.preventDefault();try{let a=await b((0,x.x4)({email:s,password:o})).unwrap();(null==a?void 0:a.status)?(i.Z.set("mofi_token",JSON.stringify(!0)),i.Z.set("auth_token",a.token),window.localStorage.setItem("user",JSON.stringify({fName:a.data.fName,lName:a.data.lName,role:a.data.role,email:a.data.email})),Z.push("/".concat(e,"/dashboard")),h.Am.success("Login successful"),C("")):(C(a.message||"Invalid credentials"),U(!0))}catch(e){"string"==typeof e?C(e):C("Login failed. Please try again."),U(!0)}};return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{children:(0,r.jsxs)(c.default,{className:"logo",href:"/sample_page",children:[(0,r.jsx)("img",{className:"img-fluid for-light",src:"/imgs/Clicks-Master.svg",alt:"login page",style:{width:"150px"}}),(0,r.jsx)("img",{className:"img-fluid for-dark",src:"/imgs/Clicks-White.svg",alt:"login page",style:{width:"150px"}})]})}),(0,r.jsx)("div",{className:"login-main",children:(0,r.jsxs)(g.Z,{className:"theme-form",onSubmit:A,children:[(0,r.jsx)("h4",{children:d.hOj}),(0,r.jsx)("p",{children:"Enter your email & password to login"}),k&&(0,r.jsx)(f.Z,{fade:!0,color:"danger",isOpen:_,toggle:()=>U(!1),children:k}),(0,r.jsxs)(p.Z,{children:[(0,r.jsx)(m.Z,{className:"col-form-label",children:d.SWv}),(0,r.jsx)(v.Z,{type:"email",value:s,onChange:e=>n(e.target.value),placeholder:"Enter Your Email",required:!0})]}),(0,r.jsxs)(p.Z,{children:[(0,r.jsx)(m.Z,{className:"col-form-label",children:d.rop}),(0,r.jsxs)("div",{className:"position-relative",children:[(0,r.jsx)(v.Z,{type:a?"text":"password",value:o,onChange:e=>w(e.target.value),placeholder:"Enter Your Password",required:!0}),(0,r.jsx)("div",{className:"show-hide",onClick:()=>t(!a),children:(0,r.jsx)("span",{className:"show",children:" "})})]})]}),(0,r.jsx)(p.Z,{className:"mb-0",children:(0,r.jsx)("div",{className:"text-end mt-4",children:(0,r.jsx)(y.Z,{color:"primary",block:!0,className:"w-100",type:"submit",children:d.cLy})})})]})})]})},k=()=>(0,r.jsx)(s.Z,{fluid:!0,className:"p-0",children:(0,r.jsx)(n.Z,{className:"m-0",children:(0,r.jsx)(o.Z,{xs:"12",className:"p-0",children:(0,r.jsx)("div",{className:"login-card login-dark",children:(0,r.jsx)(w,{})})})})})}},function(e){e.O(0,[2292,2586,3464,7648,3537,8206,2897,9896,1008,2971,2117,1744],function(){return e(e.s=68164)}),_N_E=e.O()}]);